{% extends 'formularios/base.html.twig' %}

    {% block body %}

        <div class="row">
            <div class="col-lg-12">

                <div class="panel panel-default">
                    <div class="panel-heading">
                        Formulario Mejoramiento
                    </div>
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-lg-12">

                                {{ form_start(form, { 'attr' : {'role' : 'form', 'class' : 'form-horizontal form-groups-bordered', 'novalidate':'novalidate' } }) }}

                                {% for name, params in form if name != '_token' and name != 'submit' %}

                                    <div class="form-group">
                                        {{ form_label(params, null, {'label_attr': {'class': 'col-sm-3 control-label'}}) }}
                                        <div class="col-sm-5">
                                            {{ form_widget(params) }}
                                            <span class="text-danger">{{ form_errors(params) }}</span>
                                        </div>
                                    </div>

                                {% endfor %}

                                <div id="cargar_ajax">

                                </div>

                                <br/>
                                <div class="col-sm-offset-3 col-sm-5">
                                    <button type="submit" class="btn btn-default" id="submit_data">Guardar</button>
                                </div>

                                {{ form_end(form) }}

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    {% endblock %}


    {% block javascripts  %}
        {{ parent() }}
        <script>
            jQuery(document).ready(function() {
                jQuery("#formulario_detalle").change(function() {
                    jQuery("#formulario_detalle option:selected").each(function() {
                        var valor = jQuery(this).val();
                        jQuery.ajax({
                            url : "{{ path('formularios_ajax_field') }}",
                            type: "POST",
                            dataType: "html",
                            data : {detalle : valor, id : "{{ id }}"},
                            error: function(errorObj) {
                                alert("Se ha presentado un error al enviar la informacion");
                            },
                            beforeSend: function() {
                                jQuery("#cargar_ajax").html('<img src="url de un loader.gif">');
                            },
                            success : function(result) {
                                jQuery("#cargar_ajax").html(result);
                            }
                        });
                    });
                });
            });
        </script>
    {% endblock %}
